# CDN了解

## 认识CDN

### 概念和产生背景

内容分发网络/内容交付网络.

互联网和万维网的区分:

- 互联网以tcp/ip为核心的网络层,是网络的基础
- 万维网www以应用为代表的应用层,是互联网中最粗的一个枝条

内容提供商sp(service provider)提供服务,用户来消费.
整个过程的优化只能发生在应用程,优化互联网很难.
目前网络传输存在4个易堵地方:

- 第一公里:sp接入互联网的带宽
- 最后一公里:用户接入互联网的带宽(现阶段4G/5G已解决这部分的瓶颈)
- 对等互联网关:不同运营商的互联互通,这是跨网问题(BGP机房少)
- 长途骨干传输:IDC/骨干网/用户城域网/用户接入网

### CDN的基本工作过程

传统访问url的过程:

- 用户将url丢给dns服务器,获取具体的ip地址
- 用户去具体的ip地址(sp)访问,获取内容

使用cdn访问url的过程:

- 用户将url丢给本地dns系统,dns会用cname记录转给cdn专用dns服务器
- cdn的dns将cdn的全局负载均衡设备ip返回给用户
- 用户将url丢给全局负载均衡设备, 设备会返回一个具体的缓存服务器
- 用户将url丢给缓存服务器,如果有,直接返回,如果没有,缓存服务器就去源站拉去数据

全局复杂均衡设备会判断用户ip(就近),
会判断url(看哪台缓存服务器有内容),
会判断各缓存服务器的负载(均衡).